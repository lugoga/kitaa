<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Masumbuko Semba">
<meta name="dcterms.date" content="2024-04-01">

<title>DATIKA - Basic plots with ggplot2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=<Insert your ID here>"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', '<Insert your ID here>', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  
<link href="../../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="../../site_libs/tabwid-1.1.3/tabwid.js"></script>


<meta name="twitter:title" content="DATIKA - Basic plots with ggplot2">
<meta name="twitter:description" content="Coding for all for better today and tommorow">
<meta name="twitter:image" content="thumbnail_blog.png">
<meta name="twitter:creator" content="@semba2024">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">DATIKA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../slides.html"> 
<span class="menu-text">Presentations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../books.html"> 
<span class="menu-text">Books</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../data.html"> 
<span class="menu-text">Datasets</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../photos.html"> 
<span class="menu-text">Gallery</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/lugoga/kitaa"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-ressources" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Ressources</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-ressources">    
        <li>
    <a class="dropdown-item" href="https://semba-blog.netlify.app/">
 <span class="dropdown-text">Semba blog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://lugoga.github.io/semba-quarto/">
 <span class="dropdown-text">Semba website</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://nyamisi.github.io/nyamisi/blog.html">
 <span class="dropdown-text">Nyamisi blog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://rweekly.org/">
 <span class="dropdown-text">R Weekly</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.r-bloggers.com/">
 <span class="dropdown-text">R Bloggers</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../archive.html"> 
<span class="menu-text">Archive</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Basic plots with ggplot2</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">visualization</div>
                <div class="quarto-category">code</div>
                <div class="quarto-category">analysis</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://semba.netlify.app">Masumbuko Semba</a> <a href="https://orcid.org/0000-0002-5002-9747" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              <a href="https://semba.netlify.app/">
              Nelson Mandela African Institution of Science and Technology
              </a>
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 1, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#scatterplot" id="toc-scatterplot" class="nav-link" data-scroll-target="#scatterplot"><span class="header-section-number">1.1</span> Scatterplot</a></li>
  <li><a href="#linegraph" id="toc-linegraph" class="nav-link" data-scroll-target="#linegraph"><span class="header-section-number">1.2</span> Linegraph</a></li>
  <li><a href="#area-plot" id="toc-area-plot" class="nav-link" data-scroll-target="#area-plot"><span class="header-section-number">1.3</span> Area plot</a></li>
  <li><a href="#histogram" id="toc-histogram" class="nav-link" data-scroll-target="#histogram"><span class="header-section-number">1.4</span> Histogram</a></li>
  <li><a href="#frequency-polygons" id="toc-frequency-polygons" class="nav-link" data-scroll-target="#frequency-polygons"><span class="header-section-number">1.5</span> Frequency polygons</a></li>
  <li><a href="#density-plots" id="toc-density-plots" class="nav-link" data-scroll-target="#density-plots"><span class="header-section-number">1.6</span> Density plots</a></li>
  <li><a href="#boxplot" id="toc-boxplot" class="nav-link" data-scroll-target="#boxplot"><span class="header-section-number">1.7</span> Boxplot</a></li>
  <li><a href="#violin-plots" id="toc-violin-plots" class="nav-link" data-scroll-target="#violin-plots"><span class="header-section-number">1.8</span> Violin plots</a></li>
  <li><a href="#barplot" id="toc-barplot" class="nav-link" data-scroll-target="#barplot"><span class="header-section-number">1.9</span> Barplot</a></li>
  <li><a href="#pie-and-donut-charts" id="toc-pie-and-donut-charts" class="nav-link" data-scroll-target="#pie-and-donut-charts"><span class="header-section-number">1.10</span> Pie and donut charts</a></li>
  <li><a href="#bar-with-polar-tranformation" id="toc-bar-with-polar-tranformation" class="nav-link" data-scroll-target="#bar-with-polar-tranformation"><span class="header-section-number">1.11</span> Bar with polar tranformation</a></li>
  <li><a href="#ridge-plot" id="toc-ridge-plot" class="nav-link" data-scroll-target="#ridge-plot"><span class="header-section-number">1.12</span> Ridge plot</a></li>
  </ul></li>
  <li><a href="#combining-multiple-plots" id="toc-combining-multiple-plots" class="nav-link" data-scroll-target="#combining-multiple-plots"><span class="header-section-number">2</span> Combining multiple plots</a></li>
  <li><a href="#labelling-outliers" id="toc-labelling-outliers" class="nav-link" data-scroll-target="#labelling-outliers"><span class="header-section-number">3</span> Labelling outliers</a></li>
  <li><a href="#add-on-packages" id="toc-add-on-packages" class="nav-link" data-scroll-target="#add-on-packages"><span class="header-section-number">4</span> Add-on packages</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">5</span> References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>The <strong>ggplot2</strong> package provides a set of functions that mirror the <em>Grammar of Graphics</em> <span class="citation" data-cites="ggplot">(<a href="#ref-ggplot" role="doc-biblioref">Wickham, 2016</a>)</span>, enabling you to efficaciously specify what you want a plot to look like. To have a glimpse of <strong>ggplot2</strong>, we start with five basic types of plots that are familiar to most people. These include: scatterplot, linegraphs, boxplots, histograms, and barplots. The first four graphs works with <em>quantitative</em> data and barplots are appropriate for <em>categorical</em> data.</p>
<p>Thus, understanding the type of data is inevitable before you throw the variable into <strong>ggplot2</strong> to make plot for you. In this post, we will cover the most common plot types, such as line plots, histograms, pie charts, scatter plots, and bar plots, along with several other plot types that build upon these.</p>
<section id="scatterplot" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="scatterplot"><span class="header-section-number">1.1</span> Scatterplot</h3>
<p>Scatterplots are also called bivariate, allows you to visualize the association between two numerical variables. They are among the widely used plot in fisheries science particularly when looking for association between length and weight of a particular fish. Probably you might have come across a scatterplot like the one in <a href="#fig-scatter-chinook" class="quarto-xref">Figure&nbsp;1</a> that base R was used, but probably you have not made one based on the fundamental theorem of <em>grammar of graphics</em>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-scatter-chinook" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-chinook-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-scatter-chinook-1.png" class="img-fluid figure-img" data-fig-pos="H" width="336">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-chinook-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Length and weight relationship of Chinook Salmon sampled in Atantic Ocean
</figcaption>
</figure>
</div>
</div>
</div>
<p>We are going to visualize the relationship between length and weight of fish measured in the coastal waters of Kenya. We use the <code>tidy_LFQ_sample_4.csv</code> file. Let’s import the dataset in the session using <code>read_csv</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>lfq4 <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"../data/tidy/tidy_LFQ_sample_4.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This file contain length and weight measurements along with sex sampled in Mombasa and Voi from March 2016 to September 2020 (<a href="#tbl-lfq" class="quarto-xref">Table&nbsp;1</a>).</p>
<div class="cell">
<div id="tbl-lfq" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lfq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Sample length and weight of sampled fish
</figcaption>
<div aria-describedby="tbl-lfq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-7b330692{}.cl-7b2cc214{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7b2f02e0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7b2f02e1{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7b2f1226{width:0.956in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f1230{width:1.067in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f1231{width:0.701in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f1232{width:0.735in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f1233{width:0.523in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f1234{width:0.956in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f123a{width:1.067in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f123b{width:0.701in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f123c{width:0.735in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f123d{width:0.523in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f123e{width:0.956in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f1244{width:1.067in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f1245{width:0.701in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f1246{width:0.735in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f1247{width:0.523in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f124e{width:0.956in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f124f{width:1.067in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f1250{width:0.701in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f1251{width:0.735in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b2f1252{width:0.523in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-7b330692"><thead><tr style="overflow-wrap:break-word;"><th class="cl-7b2f1226"><p class="cl-7b2f02e0"><span class="cl-7b2cc214">site</span></p></th><th class="cl-7b2f1230"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">date</span></p></th><th class="cl-7b2f1231"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">tl_mm</span></p></th><th class="cl-7b2f1231"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">fl_mm</span></p></th><th class="cl-7b2f1232"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">wt_gm</span></p></th><th class="cl-7b2f1233"><p class="cl-7b2f02e0"><span class="cl-7b2cc214">sex</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-7b2f1234"><p class="cl-7b2f02e0"><span class="cl-7b2cc214">Mombasa</span></p></td><td class="cl-7b2f123a"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">2019-04-05</span></p></td><td class="cl-7b2f123b"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">184</span></p></td><td class="cl-7b2f123b"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">169</span></p></td><td class="cl-7b2f123c"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">59.50</span></p></td><td class="cl-7b2f123d"><p class="cl-7b2f02e0"><span class="cl-7b2cc214">M</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7b2f1234"><p class="cl-7b2f02e0"><span class="cl-7b2cc214">Mombasa</span></p></td><td class="cl-7b2f123a"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">2019-04-05</span></p></td><td class="cl-7b2f123b"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">185</span></p></td><td class="cl-7b2f123b"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">169</span></p></td><td class="cl-7b2f123c"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">54.71</span></p></td><td class="cl-7b2f123d"><p class="cl-7b2f02e0"><span class="cl-7b2cc214">M</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7b2f123e"><p class="cl-7b2f02e0"><span class="cl-7b2cc214">Mombasa</span></p></td><td class="cl-7b2f1244"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">2019-04-05</span></p></td><td class="cl-7b2f1245"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">145</span></p></td><td class="cl-7b2f1245"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">134</span></p></td><td class="cl-7b2f1246"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">24.15</span></p></td><td class="cl-7b2f1247"><p class="cl-7b2f02e0"><span class="cl-7b2cc214">M</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7b2f1234"><p class="cl-7b2f02e0"><span class="cl-7b2cc214">Voi</span></p></td><td class="cl-7b2f123a"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">2020-09-11</span></p></td><td class="cl-7b2f123b"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">189</span></p></td><td class="cl-7b2f123b"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">174</span></p></td><td class="cl-7b2f123c"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">65.88</span></p></td><td class="cl-7b2f123d"><p class="cl-7b2f02e0"><span class="cl-7b2cc214">F</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7b2f123e"><p class="cl-7b2f02e0"><span class="cl-7b2cc214">Voi</span></p></td><td class="cl-7b2f1244"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">2020-09-11</span></p></td><td class="cl-7b2f1245"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">162</span></p></td><td class="cl-7b2f1245"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">147</span></p></td><td class="cl-7b2f1246"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">36.35</span></p></td><td class="cl-7b2f1247"><p class="cl-7b2f02e0"><span class="cl-7b2cc214">F</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7b2f124e"><p class="cl-7b2f02e0"><span class="cl-7b2cc214">Voi</span></p></td><td class="cl-7b2f124f"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">2020-09-11</span></p></td><td class="cl-7b2f1250"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">168</span></p></td><td class="cl-7b2f1250"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">153</span></p></td><td class="cl-7b2f1251"><p class="cl-7b2f02e1"><span class="cl-7b2cc214">46.13</span></p></td><td class="cl-7b2f1252"><p class="cl-7b2f02e0"><span class="cl-7b2cc214">F</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
<p>Let’s now dive into the code of using the *grammar of graphics<strong> to create the scatterplot. We use the <code>ggplot()</code> function from </strong>ggplot2** package. The code highlighted in the chunk below was used to plot <a href="#fig-scatter1" class="quarto-xref">Figure&nbsp;2</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lfq4, <span class="fu">aes</span>(<span class="at">x =</span> tl_mm, <span class="at">y =</span> wt_gm))<span class="sc">+</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total length (mm)"</span>, <span class="at">y =</span> <span class="st">"Weight (gm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatter1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-scatter1-1.png" class="img-fluid figure-img" data-fig-pos="H" width="288">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Length and weight relationship
</figcaption>
</figure>
</div>
</div>
</div>
<p>Let’s explore the code above piece-by-piece</p>
<ul>
<li>The plotting in <strong>ggplot2</strong> begin with <code>ggplot()</code> function, where the two components of <em>grammar of graphics</em> are required. in the <code>data</code> component we specified the dataset by setting <code>data = lfq4</code>. Then the second argument <code>aes</code>thetic that map the plot with coordinate was set by <code>aes(x = tl_mm, y = wt_gm))</code>. In a nutshell, the <code>aes()</code> define the variable – axis specifications.</li>
<li>We then added a layer to the <code>ggplot()</code> function call using the <code>+</code> sign. The added layer specify the third part of the *grammar—the <code>geom</code>etric component. Because we want to plot scatterplot, the appropriate <code>geom</code> for this case is the <code>geom_point()</code>.</li>
<li>added a layer <code>labs</code> that allows us to label axis with meaningful axis titles</li>
</ul>
<p><strong>adding regression line</strong> you can simply add the regression line by adding a <code>geom_smooth()</code> layer. However, <a href="#fig-scatter1" class="quarto-xref">Figure&nbsp;2</a> is non-linear and hence we need to specify the modal that fits the data, the <code>loess</code> model is mostly used for non-linear data. Therefore, we parse the argument<code>method = "loess"</code> to draw a non-linear regression line but also parse an argument <code>se = FALSE</code> to prevent plotting confidence error.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4, <span class="fu">aes</span>(<span class="at">x =</span> tl_mm, <span class="at">y =</span> wt_gm))<span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total length (mm)"</span>, <span class="at">y =</span> <span class="st">"Weight (gm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatter2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-scatter2-1.png" class="img-fluid figure-img" data-fig-pos="H" width="288">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Length and weight relationship with non-linear regression line
</figcaption>
</figure>
</div>
</div>
</div>
<p>If we want to add a linear regression line i the scatter plot instead of the non linear shown in <span class="citation" data-cites="ig-scatter2">(<a href="#ref-ig-scatter2" role="doc-biblioref"><strong>ig-scatter2?</strong></a>)</span>, we simply replace <code>method = "loess"</code> with <code>method = "lm"</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4, <span class="fu">aes</span>(<span class="at">x =</span> tl_mm, <span class="at">y =</span> wt_gm))<span class="sc">+</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total length (mm)"</span>, <span class="at">y =</span> <span class="st">"Weight (gm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatter3" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-scatter3-1.png" class="img-fluid figure-img" data-fig-pos="H" width="288">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Length and weight relationship with linear regression line
</figcaption>
</figure>
</div>
</div>
</div>
<p>The linear regression line we added in <a href="#fig-scatter3" class="quarto-xref">Figure&nbsp;4</a> does not fit the data points. That’s is nature of the length and weight measurements of most fishes as their growth is allometric and not isometric. To make use of the linear model in such data points, we often log-transform the data points first and replot. But in <strong>ggplot</strong> framework, you do need to do that but simply add the <code>scale_x_log10</code> and <code>scale_y_log10</code> layer</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4, <span class="fu">aes</span>(<span class="at">x =</span> tl_mm, <span class="at">y =</span> wt_gm))<span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total length (mm)"</span>, <span class="at">y =</span> <span class="st">"Weight (gm)"</span>)<span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatter4" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-scatter4-1.png" class="img-fluid figure-img" data-fig-pos="H" width="288">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Log-transformed length and weight relationship with linear regression line
</figcaption>
</figure>
</div>
</div>
</div>
<p>Knowing whether the relationship is positive or negative and whether is linear or non linear is one thing, but people would like to know the strength of the relationship that you have simply presented in <a href="#fig-scatter4" class="quarto-xref">Figure&nbsp;5</a>. Luckily, Pedro Aphalo developed a <strong>ggpmisc</strong> package <span class="citation" data-cites="ggpmisc">(<a href="#ref-ggpmisc" role="doc-biblioref">Aphalo, 2016</a>)</span>, which extend the statistical function of <strong>ggplot2</strong>. By simply adding a layer <code>ggpmisc::stat_correlation()</code> in <a href="#fig-scatter4" class="quarto-xref">Figure&nbsp;5</a>, the function generates labels for correlation coefficients and p-value, coefficient of determination (R^2) for method “pearson” and number of observations and add them into the plot (<a href="#fig-scatter0" class="quarto-xref">Figure&nbsp;6</a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4, <span class="fu">aes</span>(<span class="at">x =</span> tl_mm, <span class="at">y =</span> wt_gm))<span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total length (mm)"</span>, <span class="at">y =</span> <span class="st">"Weight (gm)"</span>)<span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="fu">scale_y_log10</span>()<span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>  ggpmisc<span class="sc">::</span><span class="fu">stat_correlation</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatter0" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-scatter0-1.png" class="img-fluid figure-img" data-fig-pos="H" width="288">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Log-transformed length and weight relationship with linear regression line with correlation coefficient
</figcaption>
</figure>
</div>
</div>
</div>
<p>We might be interested to distinguish the data points and the regression line based on the site. We can do that by adding the color argument in the aesthetic, which change from <code>aes(x = tl_mm, y = wt_gm)</code> to <code>aes(x = tl_mm, y = wt_gm, color = site)</code>. The argument <code>color = site</code> will force the data points and the regression line to adhere to colors based on the site but the points and line are plotted on the same plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4, <span class="fu">aes</span>(<span class="at">x =</span> tl_mm, <span class="at">y =</span> wt_gm, <span class="at">color =</span> site))<span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total length (mm)"</span>, <span class="at">y =</span> <span class="st">"Weight (gm)"</span>)<span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="fu">scale_y_log10</span>()<span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  ggpmisc<span class="sc">::</span><span class="fu">stat_correlation</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatter41" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter41-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-scatter41-1.png" class="img-fluid figure-img" data-fig-pos="H" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter41-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Log-transformed length and weight relationship with linear regression line by site
</figcaption>
</figure>
</div>
</div>
</div>
<p>Looking on <a href="#fig-scatter41" class="quarto-xref">Figure&nbsp;7</a>, it is clear that sample from Mombasa station has relatively bigger and heavier fish than those sampled from Voi. But the problem with <a href="#fig-scatter41" class="quarto-xref">Figure&nbsp;7</a> is that most of the Mombasa data points are masked by Voi data points, which are overlaid on Mombasa data points. We can overcome the issue of point cluttering by simply adding a transparency level in point with <code>alpha = .2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4, <span class="fu">aes</span>(<span class="at">x =</span> tl_mm, <span class="at">y =</span> wt_gm, <span class="at">color =</span> site))<span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total length (mm)"</span>, <span class="at">y =</span> <span class="st">"Weight (gm)"</span>)<span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>  ggpmisc<span class="sc">::</span><span class="fu">stat_correlation</span>()<span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>  <span class="fu">scale_y_log10</span>()<span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>  ggpmisc<span class="sc">::</span><span class="fu">stat_correlation</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatter5" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-scatter5-1.png" class="img-fluid figure-img" data-fig-pos="H" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Log-transformed length and weight relationship with linear regression line by site. Points density is highlighted with transparency
</figcaption>
</figure>
</div>
</div>
</div>
<p>Sometimes you may wish to plot <a href="#fig-scatter5" class="quarto-xref">Figure&nbsp;8</a> as separate plot shown in <a href="#fig-scatter6" class="quarto-xref">Figure&nbsp;9</a>. That’s is achieved with <code>facet_wrap</code> function, which facet plots based on the levels that are in the variable that is specified. For instance, in our case, the variable chosen is site and there are two sites–Voi and Mombasa. Therefore by simply adding a <code>facet_wrap(~site)</code> layer will force ggplot to make two plots</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4, <span class="fu">aes</span>(<span class="at">x =</span> tl_mm, <span class="at">y =</span> wt_gm))<span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total length (mm)"</span>, <span class="at">y =</span> <span class="st">"Weight (gm)"</span>)<span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>  <span class="fu">scale_y_log10</span>()<span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>  ggpmisc<span class="sc">::</span><span class="fu">stat_correlation</span>()<span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>site, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatter6" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-scatter6-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Faceted Log-transformed length and weight relationship with linear regression line
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="linegraph" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="linegraph"><span class="header-section-number">1.2</span> Linegraph</h3>
<p>The next basic graph of <strong>ggplot2</strong> is the linegraph. Line graphs is similar to drawing points, except that it connects the points with line. often times you don’t show the points. Let’s illustrate how to create linegraphs using catch data in the region. We first load the dataset in the session</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>landing.countries <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"../data/tidy/landings_wio_country.csv"</span>, <span class="at">skip =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>landing.countries</code> dataset contain 660 records of landed fisheries catch information recorded between 1950 and 2015 from Somalia, Kenya, Mozambique, South Africa, Madagascar, Mauritius, Seychelles, Mayotte, Tanzania and Zanzibar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>landing.countries <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2"></a>  FSA<span class="sc">::</span><span class="fu">headtail</span>() <span class="sc">|&gt;</span> </span>
<span id="cb11-3"><a href="#cb11-3"></a>  flextable<span class="sc">::</span><span class="fu">flextable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb11-4"><a href="#cb11-4"></a>  flextable<span class="sc">::</span><span class="fu">autofit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-7e2ad0f0{}.cl-7e243b6e{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7e26b4a2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7e26b4ac{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7e26c866{width:1.126in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e26c870{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e26c871{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e26c87a{width:0.701in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e26c87b{width:1.126in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e26c884{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e26c885{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e26c88e{width:0.701in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e26c88f{width:1.126in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e26c890{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e26c898{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e26c899{width:0.701in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-7e2ad0f0"><thead><tr style="overflow-wrap:break-word;"><th class="cl-7e26c866"><p class="cl-7e26b4a2"><span class="cl-7e243b6e">name</span></p></th><th class="cl-7e26c870"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">year</span></p></th><th class="cl-7e26c871"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">catch</span></p></th><th class="cl-7e26c87a"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">epoch</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-7e26c87b"><p class="cl-7e26b4a2"><span class="cl-7e243b6e">Kenya</span></p></td><td class="cl-7e26c884"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">1,950</span></p></td><td class="cl-7e26c885"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">19,154</span></p></td><td class="cl-7e26c88e"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">1,960</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7e26c87b"><p class="cl-7e26b4a2"><span class="cl-7e243b6e">Kenya</span></p></td><td class="cl-7e26c884"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">1,951</span></p></td><td class="cl-7e26c885"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">21,318</span></p></td><td class="cl-7e26c88e"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">1,960</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7e26c87b"><p class="cl-7e26b4a2"><span class="cl-7e243b6e">Kenya</span></p></td><td class="cl-7e26c884"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">1,952</span></p></td><td class="cl-7e26c885"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">19,126</span></p></td><td class="cl-7e26c88e"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">1,960</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7e26c87b"><p class="cl-7e26b4a2"><span class="cl-7e243b6e">Madagascar</span></p></td><td class="cl-7e26c884"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">2,013</span></p></td><td class="cl-7e26c885"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">266,953</span></p></td><td class="cl-7e26c88e"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">2,010</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7e26c87b"><p class="cl-7e26b4a2"><span class="cl-7e243b6e">Madagascar</span></p></td><td class="cl-7e26c884"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">2,014</span></p></td><td class="cl-7e26c885"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">138,478</span></p></td><td class="cl-7e26c88e"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">2,010</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7e26c88f"><p class="cl-7e26b4a2"><span class="cl-7e243b6e">Madagascar</span></p></td><td class="cl-7e26c890"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">2,015</span></p></td><td class="cl-7e26c898"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">145,629</span></p></td><td class="cl-7e26c899"><p class="cl-7e26b4ac"><span class="cl-7e243b6e">2,010</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Linegraphs are used to show time series data. Its inappropriate to use the linegraphs for data that has no clear sequential ordering and should be continuous and not discrete data type. The internal structure of the catch dataset we just loaded indicate that with exception of country’s name, year, catch and epoch are numeric values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>landing.countries <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">glimpse</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 660
Columns: 4
$ name  &lt;chr&gt; "Kenya", "Kenya", "Kenya", "Kenya", "Kenya", "Kenya", "Kenya", "…
$ year  &lt;dbl&gt; 1950, 1951, 1952, 1953, 1954, 1955, 1956, 1957, 1958, 1959, 1960…
$ catch &lt;dbl&gt; 19154, 21318, 19126, 20989, 17541, 19223, 23297, 28122, 28819, 2…
$ epoch &lt;dbl&gt; 1960, 1960, 1960, 1960, 1960, 1960, 1960, 1960, 1960, 1960, 1960…</code></pre>
</div>
</div>
<p>Let’s us plot the annual landings of fish over the period with ggplot. Like the scatterplot we made earlier, where supply the data frame in <code>data</code> argument and specified the <code>aes</code>thetic mapping with <code>x</code> and <code>y</code> coordinates, but instead of using <code>geom_point()</code>, we use the <code>geom_line()</code>. The code to make the line graph of annual landing in the WIO region shown in <a href="#fig-line1" class="quarto-xref">Figure&nbsp;10</a> is written as;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> landing.countries,</span>
<span id="cb14-2"><a href="#cb14-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> catch)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Annual catch (MT)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-line1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-line1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-line1-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-line1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Annual alnding in the WIO region
</figcaption>
</figure>
</div>
</div>
</div>
<p>Although we added a <code>geom_line</code>, but we notice that <a href="#fig-line1" class="quarto-xref">Figure&nbsp;10</a> display a plot which we did not expect. The problem is that line for the ten countries are all lumped together and result in the chaotic situation. For illustration purpose, I will use the catch data from Mauritius. Let’s filter Mauritius’ catch information from the <code>landing.countries</code> dataset and display its rows and variables;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>mauritius.landings <span class="ot">=</span> landing.countries <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">"Mauritius"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>mauritius.landings <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2"></a>  FSA<span class="sc">::</span><span class="fu">headtail</span>() <span class="sc">|&gt;</span> </span>
<span id="cb16-3"><a href="#cb16-3"></a>  flextable<span class="sc">::</span><span class="fu">flextable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb16-4"><a href="#cb16-4"></a>  flextable<span class="sc">::</span><span class="fu">autofit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-7e5cb12e{}.cl-7e54fb46{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7e588dd8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7e588dec{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7e589e86{width:0.905in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e589e90{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e589e91{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e589e92{width:0.701in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e589e9a{width:0.905in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e589e9b{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e589e9c{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e589e9d{width:0.701in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e589ea4{width:0.905in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e589ea5{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e589ea6{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e589ea7{width:0.701in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-7e5cb12e"><thead><tr style="overflow-wrap:break-word;"><th class="cl-7e589e86"><p class="cl-7e588dd8"><span class="cl-7e54fb46">name</span></p></th><th class="cl-7e589e90"><p class="cl-7e588dec"><span class="cl-7e54fb46">year</span></p></th><th class="cl-7e589e91"><p class="cl-7e588dec"><span class="cl-7e54fb46">catch</span></p></th><th class="cl-7e589e92"><p class="cl-7e588dec"><span class="cl-7e54fb46">epoch</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-7e589e9a"><p class="cl-7e588dd8"><span class="cl-7e54fb46">Mauritius</span></p></td><td class="cl-7e589e9b"><p class="cl-7e588dec"><span class="cl-7e54fb46">1,950</span></p></td><td class="cl-7e589e9c"><p class="cl-7e588dec"><span class="cl-7e54fb46">183,082</span></p></td><td class="cl-7e589e9d"><p class="cl-7e588dec"><span class="cl-7e54fb46">1,960</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7e589e9a"><p class="cl-7e588dd8"><span class="cl-7e54fb46">Mauritius</span></p></td><td class="cl-7e589e9b"><p class="cl-7e588dec"><span class="cl-7e54fb46">1,951</span></p></td><td class="cl-7e589e9c"><p class="cl-7e588dec"><span class="cl-7e54fb46">216,151</span></p></td><td class="cl-7e589e9d"><p class="cl-7e588dec"><span class="cl-7e54fb46">1,960</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7e589e9a"><p class="cl-7e588dd8"><span class="cl-7e54fb46">Mauritius</span></p></td><td class="cl-7e589e9b"><p class="cl-7e588dec"><span class="cl-7e54fb46">1,952</span></p></td><td class="cl-7e589e9c"><p class="cl-7e588dec"><span class="cl-7e54fb46">181,822</span></p></td><td class="cl-7e589e9d"><p class="cl-7e588dec"><span class="cl-7e54fb46">1,960</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7e589e9a"><p class="cl-7e588dd8"><span class="cl-7e54fb46">Mauritius</span></p></td><td class="cl-7e589e9b"><p class="cl-7e588dec"><span class="cl-7e54fb46">2,013</span></p></td><td class="cl-7e589e9c"><p class="cl-7e588dec"><span class="cl-7e54fb46">15,797</span></p></td><td class="cl-7e589e9d"><p class="cl-7e588dec"><span class="cl-7e54fb46">2,010</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7e589e9a"><p class="cl-7e588dd8"><span class="cl-7e54fb46">Mauritius</span></p></td><td class="cl-7e589e9b"><p class="cl-7e588dec"><span class="cl-7e54fb46">2,014</span></p></td><td class="cl-7e589e9c"><p class="cl-7e588dec"><span class="cl-7e54fb46">13,879</span></p></td><td class="cl-7e589e9d"><p class="cl-7e588dec"><span class="cl-7e54fb46">2,010</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7e589ea4"><p class="cl-7e588dd8"><span class="cl-7e54fb46">Mauritius</span></p></td><td class="cl-7e589ea5"><p class="cl-7e588dec"><span class="cl-7e54fb46">2,015</span></p></td><td class="cl-7e589ea6"><p class="cl-7e588dec"><span class="cl-7e54fb46">16,373</span></p></td><td class="cl-7e589ea7"><p class="cl-7e588dec"><span class="cl-7e54fb46">2,010</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>There are only 66 rows in Mauritius which are equivalent to 66 records each per year from 1950 to 2015. Let’s use the <code>mauritius.landings</code> dataset to plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mauritius.landings,</span>
<span id="cb17-2"><a href="#cb17-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> catch)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Annual catch (MT)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-line2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-line2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-line2-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-line2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Mauritius’ annual landing
</figcaption>
</figure>
</div>
</div>
</div>
<p>Often times you find that linegraphs has points. You can also do that in ggplot environment by adding a <code>geom_point</code> layer</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mauritius.landings,</span>
<span id="cb18-2"><a href="#cb18-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> catch)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Annual catch (MT)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-line3" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-line3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-line3-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-line3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Mauritius’ annual landing
</figcaption>
</figure>
</div>
</div>
</div>
<p>You can also customize the appearance of the line and point by parsing the color argument in the geom_point and geom_line layers</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mauritius.landings,</span>
<span id="cb19-2"><a href="#cb19-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> catch)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Annual catch (MT)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-line4" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-line4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-line4-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-line4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Mauritius’ annual landing
</figcaption>
</figure>
</div>
</div>
</div>
<p>The problem we faced in <a href="#fig-line1" class="quarto-xref">Figure&nbsp;10</a> is that catch data for all ten countries were pooled together, and the plot was not informative. But what is we want to compare the trend of catch among the countries. That is achieved by simply distinguishing the color layer for each country. That is done by adding an argument <code>color=name</code> in <code>aes</code> function as the code below highlight</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> landing.countries,</span>
<span id="cb20-2"><a href="#cb20-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> catch, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="co"># geom_point(color = "red")+</span></span>
<span id="cb20-5"><a href="#cb20-5"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Annual catch (MT)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-line5" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-line5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-line5-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-line5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: Annual landing by countries in the WIO region
</figcaption>
</figure>
</div>
</div>
</div>
<p>The landings from South Africa is far higher than the rest of the WIO’s countries, which overshadow the appearance of other countries (<a href="#fig-line5" class="quarto-xref">Figure&nbsp;14</a>). There several approaches to resolve this issues where some countries have low catch values while others have relatively very high catches. For our case, we have decided to remove South Africa from the plot. We can do that by negating the selection with <code>filter</code> function from <strong>dplyr</strong> package. By parsing <code>filter(!name == "South Africa")</code>, note the exclamation mark before <code>name</code> tell to reverse selection and therefore select all countries except South Africa.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>other.countries <span class="ot">=</span> landing.countries <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span>name <span class="sc">==</span> <span class="st">"South Africa"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then plot and parse the argument <code>data = other.countries</code> instead of <code>data = landing.countries</code> to make <a href="#fig-line7" class="quarto-xref">Figure&nbsp;15</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> other.countries,</span>
<span id="cb22-2"><a href="#cb22-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> catch, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="co"># geom_point(color = "red")+</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Annual catch (MT)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-line7" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-line7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-line7-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-line7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: Annual landing by countries in the WIO region with South Africa ommited
</figcaption>
</figure>
</div>
</div>
</div>
<p>We notice that Tanzania and Zanzibar are presented as separate entity. Although the two states report to the FAO separate, but would be interested to know the landing of the combined Tanzania and Zanzibar catches. But before we combine these two states, lets see how their catches vary over the period. First we need to select only records for Tanzania and Zanzibar using a <code>filter</code> function as illustrated below;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>tanzania.zanzibar <span class="ot">=</span> landing.countries <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">filter</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Tanzania"</span>, <span class="st">"Zanzibar"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once we have created a <code>tanzania.zanzibar</code> object, we can use it to make plots that compare catch trend of Tanzania and Zanzibar over the last 66 years. The code in this chunk is used to make <a href="#fig-line8" class="quarto-xref">Figure&nbsp;16</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> tanzania.zanzibar,</span>
<span id="cb24-2"><a href="#cb24-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> catch, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="co"># geom_point(color = "red")+</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Annual catch (MT)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-line8" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-line8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-line8-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-line8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: Annual landing for mainland Tanzania and Zanzibar
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>landing.countries <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">str_replace</span>(<span class="at">string =</span> name, </span>
<span id="cb25-3"><a href="#cb25-3"></a>                            <span class="at">pattern =</span> <span class="st">"Zanzibar"</span>, </span>
<span id="cb25-4"><a href="#cb25-4"></a>                            <span class="at">replacement =</span> <span class="st">"Tanzania"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-5"><a href="#cb25-5"></a>  <span class="fu">filter</span>(<span class="sc">!</span>name <span class="sc">==</span> <span class="st">"South Africa"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-6"><a href="#cb25-6"></a>  <span class="fu">group_by</span>(name, year) <span class="sc">%&gt;%</span> </span>
<span id="cb25-7"><a href="#cb25-7"></a>  <span class="fu">summarise</span>(<span class="at">catch_new =</span> <span class="fu">sum</span>(catch, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-8"><a href="#cb25-8"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb25-9"><a href="#cb25-9"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> catch_new, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11"></a>  <span class="co"># geom_point(color = "red")+</span></span>
<span id="cb25-12"><a href="#cb25-12"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Annual catch (MT)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-line9" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-line9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-line9-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-line9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: Annual landing for WIO where mainland Tanzania and Zanzibar are combined
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="area-plot" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="area-plot"><span class="header-section-number">1.3</span> Area plot</h3>
<p>The <code>geom_area</code> method is used to create an area plot. It can be used as a component in the <strong>ggplot</strong> method. The <code>alpha</code> parameter in the <code>geom_area</code> method is used to depict the opacity of a genome, the value ranges from zero to one integral values. In case, we choose a lower value, this means that a more transparent color version will be chosen to depict the plot and its smoothness. We have used the value for the alpha parameter to be one by two means it is somewhat translucent in nature.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> tanzania.zanzibar,</span>
<span id="cb26-2"><a href="#cb26-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> catch, <span class="at">fill =</span> name)) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">position=</span><span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="co"># geom_point(color = "red")+</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Annual catch (MT)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-line-area" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-line-area-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-line-area-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-line-area-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18: Area plot showing Annual landing for mainland Tanzania and Zanzibar
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="histogram" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="histogram"><span class="header-section-number">1.4</span> Histogram</h3>
<p>A histogram is a plot that can be used to examine the shape and spread of continuous data. It looks very similar to a bar graph and organized in intervals or classes. It divides the range of the data into <code>bin</code> equal intervals (also called bins or classes), count the number of observations in each bin, and display the frequency distribution of observations as a bar plot. Such histogram plots provide valuable information on the characteristics of the data, such as the <code>central tendency</code>, the <code>dispersion</code> and the general <code>shape</code> of the distribution. With <code>lfq4</code> dataset, we can plot the histogram of <code>tl_mm</code>. Since histogram works for single variable that contains quantitative values, you can not bother looking for relationship as we have seen in previous plots, but histogram offers an opportunity to answer question like</p>
<ol type="1">
<li>What are the smallest and largest values of tl_mm?</li>
<li>What is the center value? 3 How does these values spread out?</li>
</ol>
<p>We can make a histogram shown in <a href="#fig-hist" class="quarto-xref">Figure&nbsp;19</a> by simply setting <code>aes(x = tl_mm)</code> and add <code>geom_histogram()</code>. Within the <code>geom_histogram()</code>, we simply specify the number of bins <code>bins = 30</code>, fill color for the colum and also the color separating each columns of the histogram with <code>col == "red"</code> and <code>fill = "red"</code>. However, a word of caution regarding histograms—bin size matters. The reproducible code to plot <a href="#fig-hist" class="quarto-xref">Figure&nbsp;19</a> is written as;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4,</span>
<span id="cb27-2"><a href="#cb27-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl_mm)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>)<span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total length (mm)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-hist" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-hist-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19: Histogram of total length
</figcaption>
</figure>
</div>
</div>
</div>
<p>The resulting histogram gives us an idea of the range of total length of fish we can expect from the sample. You may be interested to compare histogram of the data values sampled from two or sites. For example, in our case, we are interested to compare the distribution of total length using samples collected from Mombasa and Voi sites. We simply add the <code>fill = site</code> argument in the <code>aes</code> function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4,</span>
<span id="cb28-2"><a href="#cb28-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl_mm, <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total length (mm)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-hist2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-hist2-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20: Histogram of total length by sites
</figcaption>
</figure>
</div>
</div>
</div>
<p>The histogram of Mombasa and Voi is plotted as shown in <a href="#fig-hist2" class="quarto-xref">Figure&nbsp;20</a>, however, despite the transparency level of the bins is set to 0.6 (alpha = .6), yet the bins from Mombasa are masked with bins from Voi. The voi bins are plotted over the Mombasa ones and prevent us to visualize the underneath Mombasa bins. To correct for this issue, we need to parse <code>position = "identity"</code>in the <code>geom_bin</code>, which create an different color where the Mombasa and Voi bins are intersected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4,</span>
<span id="cb29-2"><a href="#cb29-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl_mm, <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">position =</span> <span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total length (mm)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-hist3" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-hist3-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21: Histogram of total length by sites
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="frequency-polygons" class="level3" data-number="1.5">
<h3 data-number="1.5" class="anchored" data-anchor-id="frequency-polygons"><span class="header-section-number">1.5</span> Frequency polygons</h3>
<p>It is often useful to visualise the distribution of a numerical variable. Comparing the distributions of different groups can lead to important insights. Visualising distributions is also essential when checking assumptions used for various statistical tests (sometimes called initial data analysis). In this section we will illustrate how this can be done using the diamonds data from the <strong>ggplot2</strong> package, which you started to explore in Chapter 2.</p>
<p>An advantage with frequency polygons is that they can be used to compare groups, e.g.&nbsp;diamonds with different cuts, without facetting:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4,</span>
<span id="cb30-2"><a href="#cb30-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl_mm, <span class="at">color =</span> site)) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">position =</span> <span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total length (mm)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-freqpoly" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-freqpoly-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-freqpoly-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-freqpoly-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22: Frequency polygon of total length by sites
</figcaption>
</figure>
</div>
</div>
</div>
<p>It is clear from this figure that the total length of fish from Voi is larger in size than those from Mombasa. The polygons have roughly the same shape, except the shape of Mombasa a long right tail indicating the presence of outlier points.</p>
</section>
<section id="density-plots" class="level3" data-number="1.6">
<h3 data-number="1.6" class="anchored" data-anchor-id="density-plots"><span class="header-section-number">1.6</span> Density plots</h3>
<p>In some cases, we are more interested in the shape of the distribution than in the actual counts in the different bins. Density plots are similar to frequency polygons but show an estimate of the density function of the underlying random variable. These estimates are smooth curves that are scaled so that the area below them is 1 (i.e.&nbsp;scaled to be proper density functions):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co">#|</span></span>
<span id="cb31-2"><a href="#cb31-2"></a></span>
<span id="cb31-3"><a href="#cb31-3"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4,</span>
<span id="cb31-4"><a href="#cb31-4"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl_mm, <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total length (mm)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-density" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-density-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;23: Density plot of total length by sites
</figcaption>
</figure>
</div>
</div>
</div>
<p>From <a href="#fig-density" class="quarto-xref">Figure&nbsp;23</a>, it’s clear that small size fish tend to have better total length, which wasn’t obvious from the frequency polygons. However, the plot does not provide any information about how common different total length are.</p>
</section>
<section id="boxplot" class="level3" data-number="1.7">
<h3 data-number="1.7" class="anchored" data-anchor-id="boxplot"><span class="header-section-number">1.7</span> Boxplot</h3>
<p>The boxplot is a standardized way of displaying the distribution of data based on the five number summary: minimum, first quantile, median, third quantile, and maximum. Boxplots are useful for detecting outliers and for comparing distributions. These five number summary also called the 25<sup>th</sup> percentile, median, and 75<sup>th</sup> percentile of the quantitative data. The whisker (vertical lines) capture roungly 99% of a distribution, and observation outside this range are plotted as points representing outliers as shown in <a href="#fig-boxplot1" class="quarto-xref">Figure&nbsp;24</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-boxplot1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="boxplot-01.png" class="img-fluid figure-img" data-fig-pos="H" width="412">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;24: Conceputal boxplot diagram
</figcaption>
</figure>
</div>
</div>
</div>
<p>Boxplots is one of statistical plot that present continuous variable and in <strong>ggplot</strong> a <code>geom_boxplot()</code> function is dedicated for that. The aes function always have at least two arguments. The first argument should be a categrial variable and the second one is numeric.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4,</span>
<span id="cb32-2"><a href="#cb32-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> tl_mm)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">position =</span> <span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sites"</span>, <span class="at">y =</span> <span class="st">"Total length (mm)"</span>)<span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-boxplot2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-boxplot2-1.png" class="img-fluid figure-img" data-fig-pos="H" width="288">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;25: Boxplot of total length by sites
</figcaption>
</figure>
</div>
</div>
</div>
<p>the <code>geom_boxplot()</code> has <code>outlier_</code> arguments that allows to highlight and modify the color, shape, size, alpha … etc of outliers —extreme observation. For instance, you can highlight the outlier with;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4,</span>
<span id="cb33-2"><a href="#cb33-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> tl_mm, <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">position =</span> <span class="st">"identity"</span>, <span class="at">outlier.colour =</span> <span class="st">"red"</span>, <span class="at">outlier.color =</span> )<span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sites"</span>, <span class="at">y =</span> <span class="st">"Total length (mm)"</span>)<span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-boxplot3" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-boxplot3-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26: Boxplot of total length by sites
</figcaption>
</figure>
</div>
</div>
</div>
<p>We can also map the fill and color to variable in to distinguish boxplot. for example, we can specify the <code>fill = site</code> argument in the <code>aes()</code> to fill the boxplot based on site.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4,</span>
<span id="cb34-2"><a href="#cb34-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> tl_mm, <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">position =</span> <span class="st">"identity"</span>, <span class="at">outlier.colour =</span> <span class="st">"red"</span>, <span class="at">outlier.color =</span> )<span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sites"</span>, <span class="at">y =</span> <span class="st">"Total length (mm)"</span>)<span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-boxplot4" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-boxplot4-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27: Boxplot of total length and color to distinguish sites
</figcaption>
</figure>
</div>
</div>
</div>
<p>We can add the points on top of the boxplot with the <code>geom_jitter()</code>. It also allows for specifying other arguments like colors and width of the points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4,</span>
<span id="cb35-2"><a href="#cb35-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> tl_mm, <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">position =</span> <span class="st">"identity"</span>, </span>
<span id="cb35-4"><a href="#cb35-4"></a>               <span class="at">outlier.colour =</span> <span class="st">"red"</span>, <span class="at">outlier.color =</span> )<span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> .<span class="dv">5</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sites"</span>, <span class="at">y =</span> <span class="st">"Total length (mm)"</span>)<span class="sc">+</span></span>
<span id="cb35-7"><a href="#cb35-7"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-boxplot5" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-boxplot5-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;28: Boxplot with points of total length by sites
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="violin-plots" class="level3" data-number="1.8">
<h3 data-number="1.8" class="anchored" data-anchor-id="violin-plots"><span class="header-section-number">1.8</span> Violin plots</h3>
<p>Instead of using a boxplot, we can use a violin plot. Each group is represented by a “violin”, given by a rotated and duplicated density plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4,</span>
<span id="cb36-2"><a href="#cb36-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> tl_mm, <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">position =</span> <span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sites"</span>, <span class="at">y =</span> <span class="st">"Total length (mm)"</span>)<span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-violin" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-violin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-violin-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-violin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;29: Violin of total length by sites
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="barplot" class="level3" data-number="1.9">
<h3 data-number="1.9" class="anchored" data-anchor-id="barplot"><span class="header-section-number">1.9</span> Barplot</h3>
<p>Bar graphs are perhaps the widely used plot. They are typically used to display count values on the y-axis for different groups on the x-axis. There is an important distinction you should be aware of when making bar graphs. The height of a bar in barplot may represent either the counts or percentage of elements in the dataset. Let’s begin with the former—count. We use the <code>shrimps_cleaned.csv</code> dataset, which contains weight and length of four shrimp species. To access the variable and values of this file we need to load the file using a <code>read_csv</code> function as the code in the chunk below highlight;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>shrimp <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"../data/tidy/shrimps_cleaned.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The sample dataset of shrimp is shown in <a href="#tbl-shrimp" class="quarto-xref">Table&nbsp;2</a>. It contain six variables year, season, tide, species, weight (total_wt_kg) and length (tl_mm).</p>
<div class="cell">
<div id="tbl-shrimp" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-shrimp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Shrimp dataset
</figcaption>
<div aria-describedby="tbl-shrimp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="yqgnbgqauc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yqgnbgqauc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yqgnbgqauc thead, #yqgnbgqauc tbody, #yqgnbgqauc tfoot, #yqgnbgqauc tr, #yqgnbgqauc td, #yqgnbgqauc th {
  border-style: none;
}

#yqgnbgqauc p {
  margin: 0;
  padding: 0;
}

#yqgnbgqauc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yqgnbgqauc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yqgnbgqauc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yqgnbgqauc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yqgnbgqauc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yqgnbgqauc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yqgnbgqauc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yqgnbgqauc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yqgnbgqauc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yqgnbgqauc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yqgnbgqauc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yqgnbgqauc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yqgnbgqauc .gt_spanner_row {
  border-bottom-style: hidden;
}

#yqgnbgqauc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yqgnbgqauc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yqgnbgqauc .gt_from_md > :first-child {
  margin-top: 0;
}

#yqgnbgqauc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yqgnbgqauc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yqgnbgqauc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yqgnbgqauc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yqgnbgqauc .gt_row_group_first td {
  border-top-width: 2px;
}

#yqgnbgqauc .gt_row_group_first th {
  border-top-width: 2px;
}

#yqgnbgqauc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yqgnbgqauc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yqgnbgqauc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yqgnbgqauc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yqgnbgqauc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yqgnbgqauc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yqgnbgqauc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yqgnbgqauc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yqgnbgqauc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yqgnbgqauc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yqgnbgqauc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yqgnbgqauc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yqgnbgqauc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yqgnbgqauc .gt_left {
  text-align: left;
}

#yqgnbgqauc .gt_center {
  text-align: center;
}

#yqgnbgqauc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yqgnbgqauc .gt_font_normal {
  font-weight: normal;
}

#yqgnbgqauc .gt_font_bold {
  font-weight: bold;
}

#yqgnbgqauc .gt_font_italic {
  font-style: italic;
}

#yqgnbgqauc .gt_super {
  font-size: 65%;
}

#yqgnbgqauc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yqgnbgqauc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yqgnbgqauc .gt_indent_1 {
  text-indent: 5px;
}

#yqgnbgqauc .gt_indent_2 {
  text-indent: 10px;
}

#yqgnbgqauc .gt_indent_3 {
  text-indent: 15px;
}

#yqgnbgqauc .gt_indent_4 {
  text-indent: 20px;
}

#yqgnbgqauc .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="year" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">year</th>
<th id="season" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">season</th>
<th id="tide" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">tide</th>
<th id="species" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">species</th>
<th id="total_wt_kg" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">total_wt_kg</th>
<th id="tl_mm" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">tl_mm</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="year">2008</td>
<td class="gt_row gt_left" headers="season">WET</td>
<td class="gt_row gt_left" headers="tide">STF</td>
<td class="gt_row gt_left" headers="species">Metapenaeus monoceros</td>
<td class="gt_row gt_right" headers="total_wt_kg">2.0</td>
<td class="gt_row gt_right" headers="tl_mm">21</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="year">2008</td>
<td class="gt_row gt_left" headers="season">WET</td>
<td class="gt_row gt_left" headers="tide">STF</td>
<td class="gt_row gt_left" headers="species">Metapenaeus monoceros</td>
<td class="gt_row gt_right" headers="total_wt_kg">2.0</td>
<td class="gt_row gt_right" headers="tl_mm">20</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="year">2008</td>
<td class="gt_row gt_left" headers="season">WET</td>
<td class="gt_row gt_left" headers="tide">STF</td>
<td class="gt_row gt_left" headers="species">Metapenaeus monoceros</td>
<td class="gt_row gt_right" headers="total_wt_kg">2.0</td>
<td class="gt_row gt_right" headers="tl_mm">19</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="year">2012</td>
<td class="gt_row gt_left" headers="season">DRY</td>
<td class="gt_row gt_left" headers="tide">STN</td>
<td class="gt_row gt_left" headers="species">Penaeus monodon</td>
<td class="gt_row gt_right" headers="total_wt_kg">1.7</td>
<td class="gt_row gt_right" headers="tl_mm">12</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="year">2012</td>
<td class="gt_row gt_left" headers="season">DRY</td>
<td class="gt_row gt_left" headers="tide">STN</td>
<td class="gt_row gt_left" headers="species">Fenneropenaeus indicus</td>
<td class="gt_row gt_right" headers="total_wt_kg">1.7</td>
<td class="gt_row gt_right" headers="tl_mm">14</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="year">2012</td>
<td class="gt_row gt_left" headers="season">DRY</td>
<td class="gt_row gt_left" headers="tide">STN</td>
<td class="gt_row gt_left" headers="species">Penaeus monodon</td>
<td class="gt_row gt_right" headers="total_wt_kg">1.7</td>
<td class="gt_row gt_right" headers="tl_mm">11</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>We realize that the scientific names are too long and may not fit into the plotting area. Therefore, we use a <code>case_when</code> function from dplyr package to change species name and assign it as a new variable called <code>species.short</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>shrimp <span class="ot">=</span> shrimp <span class="sc">%&gt;%</span> </span>
<span id="cb38-2"><a href="#cb38-2"></a>  <span class="fu">mutate</span>(<span class="at">species.short =</span> <span class="fu">case_when</span>(</span>
<span id="cb38-3"><a href="#cb38-3"></a>    species <span class="sc">==</span> <span class="st">"Metapenaeus monoceros"</span><span class="sc">~</span> <span class="st">"M.monoceros"</span>,</span>
<span id="cb38-4"><a href="#cb38-4"></a>    species <span class="sc">==</span> <span class="st">"Penaeus monodon"</span><span class="sc">~</span> <span class="st">"P.monodon"</span>,</span>
<span id="cb38-5"><a href="#cb38-5"></a>    species <span class="sc">==</span> <span class="st">"Fenneropenaeus indicus"</span><span class="sc">~</span> <span class="st">"F.indicus"</span>,</span>
<span id="cb38-6"><a href="#cb38-6"></a>    species <span class="sc">==</span> <span class="st">"Penaeus semisulcatus"</span><span class="sc">~</span> <span class="st">"P.semisulcatus"</span>)</span>
<span id="cb38-7"><a href="#cb38-7"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb38-8"><a href="#cb38-8"></a>  <span class="fu">relocate</span>(species.short, <span class="at">.after =</span> species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="barplot-for-count" class="level4" data-number="1.9.1">
<h4 data-number="1.9.1" class="anchored" data-anchor-id="barplot-for-count"><span class="header-section-number">1.9.1</span> Barplot for count</h4>
<p>To make the bar graph that show the number of shrimp per species over the sampling period you you simply specify the the variable <code>species</code> in the <code>x</code> coordinates in the <code>aes</code>thetic and add the <code>geom_bar()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> shrimp, <span class="fu">aes</span>(<span class="at">x =</span> species.short))<span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>  <span class="fu">geom_bar</span>()<span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Species"</span>, <span class="at">y=</span> <span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bar" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-bar-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;30: Frequency of shrimp species
</figcaption>
</figure>
</div>
</div>
</div>
<p>Then to stack the bar based on the sampling season, we add the argument <code>fill = season</code> in <code>aes()</code> part</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> shrimp, <span class="fu">aes</span>(<span class="at">x =</span> species.short, <span class="at">fill =</span> season))<span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>  <span class="fu">geom_bar</span>()<span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Species"</span>, <span class="at">y =</span><span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bar1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bar1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-bar1-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bar1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;31: Frequency of shrimp species by season
</figcaption>
</figure>
</div>
</div>
</div>
<p>You can flip the order of bar with <code>position = position_stack(reverse = TRUE)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> shrimp, <span class="fu">aes</span>(<span class="at">x =</span> species.short, <span class="at">fill =</span> season))<span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Species"</span>, <span class="at">y =</span><span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bar2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bar2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-bar2-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bar2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;32: Frequency of shrimp species by season
</figcaption>
</figure>
</div>
</div>
</div>
<p>Instead of stacking, you can dodge the bar with <code>position = position_dodge()</code> argument</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> shrimp, <span class="fu">aes</span>(<span class="at">x =</span> species.short, <span class="at">fill =</span> season))<span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>())<span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Species"</span>, <span class="at">y =</span><span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bar3" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bar3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-bar3-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bar3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;33: Frequency of shrimp species by season with span
</figcaption>
</figure>
</div>
</div>
</div>
<p>We notice that the species that only appear one season, the count for that species is span across and make the bar wideer than those species occur in both seasons. We can fix that by parsing <code>position = position_dodge(preserve = "single")</code> in the <code>geom_bar</code> function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> shrimp, <span class="fu">aes</span>(<span class="at">x =</span> species.short, <span class="at">fill =</span> season))<span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">preserve =</span> <span class="st">"single"</span>))<span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Species"</span>, <span class="at">y =</span><span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bar4" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bar4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-bar4-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bar4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;34: Frequency of shrimp species by season without span
</figcaption>
</figure>
</div>
</div>
</div>
<p>To add a black stroke color of the bar, add the argument <code>col = "black"</code> inside the <code>geom_bar()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> shrimp, <span class="fu">aes</span>(<span class="at">x =</span> species.short, <span class="at">fill =</span> season))<span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">preserve =</span> <span class="st">"single"</span>), <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Species"</span>, <span class="at">y =</span><span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bar5" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bar5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-bar5-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bar5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;35: Frequency of shrimp species by season without span with black bar color
</figcaption>
</figure>
</div>
</div>
</div>
<p>And to specify the width of the bar you specify a value in <code>width=.75</code> argument in <code>geom_bar()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> shrimp, <span class="fu">aes</span>(<span class="at">x =</span> species.short, <span class="at">fill =</span> season))<span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">preserve =</span> <span class="st">"single"</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> .<span class="dv">75</span>)<span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Species"</span>, <span class="at">y =</span><span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bar6" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bar6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-bar6-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bar6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;36: Frequency of shrimp species by season without span with black bar color
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="barplot-for-values" class="level4" data-number="1.9.2">
<h4 data-number="1.9.2" class="anchored" data-anchor-id="barplot-for-values"><span class="header-section-number">1.9.2</span> Barplot for values</h4>
<p>We have seen how to make barplot that show the count with <code>geom_bar()</code>. You can also use the barplot to show the values with the <code>geom_col()</code> function and specify what variables you want on the <code>x</code> and <code>y</code> axis. For instance, we want to show percentage of shrimp species by season. Because the <code>geom_col()</code> requires summarized statistics, we need to compute the percentage for each season as the chunk below highlight.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>shrimp.pct <span class="ot">=</span> shrimp <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2"></a>  <span class="fu">group_by</span>(species.short, season) <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb46-4"><a href="#cb46-4"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> n<span class="sc">/</span><span class="fu">sum</span>(n), </span>
<span id="cb46-5"><a href="#cb46-5"></a>         <span class="at">pct =</span> (pct <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">2</span>))</span>
<span id="cb46-6"><a href="#cb46-6"></a></span>
<span id="cb46-7"><a href="#cb46-7"></a>shrimp.pct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
# Groups:   species.short [4]
  species.short  season     n   pct
  &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;
1 F.indicus      DRY      404 100  
2 M.monoceros    DRY      539  86.9
3 M.monoceros    WET       81  13.1
4 P.monodon      DRY      738  52.4
5 P.monodon      WET      671  47.6
6 P.semisulcatus DRY      227 100  </code></pre>
</div>
</div>
<p>Once we have computed the statistics, we can use them to make barplot. Note that unlike the <code>geom_bar()</code>, which need only the <code>x</code> variable, <code>geom_col()</code> requires <code>x</code> and <code>y</code> variables specified. For illustration, we specified the <code>x = species</code>, and <code>y = pct</code> in the <code>aes()</code> to make a barplot that show the percentage of shrimp by season (<a href="#fig-bar7" class="quarto-xref">Figure&nbsp;37</a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> shrimp.pct, <span class="fu">aes</span>(<span class="at">x =</span> species.short, <span class="at">y =</span> pct, <span class="at">fill =</span> season))<span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">preserve =</span> <span class="st">"single"</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> .<span class="dv">75</span>)<span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Species"</span>, <span class="at">y =</span><span class="st">"Percentage"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bar7" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bar7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-bar7-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bar7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;37: Percentage of shrimp species by season without span with black bar color
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="pie-and-donut-charts" class="level3" data-number="1.10">
<h3 data-number="1.10" class="anchored" data-anchor-id="pie-and-donut-charts"><span class="header-section-number">1.10</span> Pie and donut charts</h3>
<p>A pie chart is a disk divided into pie-shaped pieces proportional to the relative frequencies of the classes. To obtain angle for any class, we multiply the relative frequencies by 360 degree, which corresponds to the complete circle. Either variables or attributes can be portrayed in this manner, but a pie chart is especially useful for attributes. A pie diagram for contribution of different fish groups/species to the total fish landings at a landing site of a river is shown in <a href="#fig-pie" class="quarto-xref">Figure&nbsp;38</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>shrimp <span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href="#cb49-2"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="#cb49-3"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb49-4"><a href="#cb49-4"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> <span class="fu">round</span>(n<span class="sc">/</span><span class="fu">sum</span>(n)<span class="sc">*</span><span class="dv">100</span>), <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-5"><a href="#cb49-5"></a>  <span class="fu">mutate</span>(<span class="at">species =</span> <span class="fu">str_replace</span>(<span class="at">string =</span> species, <span class="at">pattern =</span> <span class="st">" "</span>, <span class="at">replacement =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-6"><a href="#cb49-6"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"("</span>,pct,<span class="st">"%"</span>,<span class="st">")"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-7"><a href="#cb49-7"></a>  ggpubr<span class="sc">::</span><span class="fu">ggpie</span>(<span class="at">x =</span> <span class="st">"pct"</span>, <span class="at">label =</span> <span class="st">"label"</span>, <span class="at">fill =</span> <span class="st">"species"</span>, <span class="at">lab.pos =</span> <span class="st">"in"</span>, <span class="at">palette =</span> <span class="st">"jama"</span>, <span class="at">color =</span> <span class="st">"ivory"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_void</span>(), )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pie" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pie-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-pie-1.png" class="img-fluid figure-img" data-fig-pos="H" width="336">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pie-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;38: Percentage composition of prawn species
</figcaption>
</figure>
</div>
</div>
</div>
<p>An extended pie chart is donut shown in <a href="#fig-donut" class="quarto-xref">Figure&nbsp;39</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>shrimp <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="#cb50-3"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb50-4"><a href="#cb50-4"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> <span class="fu">round</span>(n<span class="sc">/</span><span class="fu">sum</span>(n)<span class="sc">*</span><span class="dv">100</span>), <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-5"><a href="#cb50-5"></a>  <span class="fu">mutate</span>(<span class="at">species =</span> <span class="fu">str_replace</span>(<span class="at">string =</span> species, <span class="at">pattern =</span> <span class="st">" "</span>, <span class="at">replacement =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-6"><a href="#cb50-6"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"("</span>,pct,<span class="st">"%"</span>,<span class="st">")"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-7"><a href="#cb50-7"></a>  ggpubr<span class="sc">::</span><span class="fu">ggdonutchart</span>(<span class="at">x =</span> <span class="st">"pct"</span>, <span class="at">label =</span> <span class="st">"label"</span>, <span class="at">fill =</span> <span class="st">"species"</span>, <span class="at">lab.pos =</span> <span class="st">"in"</span>, <span class="at">palette =</span> <span class="st">"jama"</span>, <span class="at">color =</span> <span class="st">"ivory"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_void</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-donut" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-donut-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-donut-1.png" class="img-fluid figure-img" data-fig-pos="H" width="336">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-donut-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;39: Percentage composition of prawn species
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="bar-with-polar-tranformation" class="level3" data-number="1.11">
<h3 data-number="1.11" class="anchored" data-anchor-id="bar-with-polar-tranformation"><span class="header-section-number">1.11</span> Bar with polar tranformation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>shrimp <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="#cb51-2"></a>  <span class="fu">group_by</span>(species.short) <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href="#cb51-3"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb51-4"><a href="#cb51-4"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>n) <span class="sc">%&gt;%</span> </span>
<span id="cb51-5"><a href="#cb51-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(species.short,n), <span class="at">y =</span> n, </span>
<span id="cb51-6"><a href="#cb51-6"></a>             <span class="at">fill =</span> species.short), <span class="at">stat =</span> <span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>)<span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.position =</span> <span class="st">"right"</span>, <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb51-11"><a href="#cb51-11"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>, <span class="at">name =</span> <span class="st">"Species"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-polar" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-polar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-polar-1.png" class="img-fluid figure-img" data-fig-pos="H" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-polar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;40: Barplot with polar transformation
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>shrimp <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="#cb52-2"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> tide, <span class="at">fill =</span> species.short),</span>
<span id="cb52-4"><a href="#cb52-4"></a>           <span class="at">color =</span> <span class="st">"ivory"</span>) <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tide"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6"></a>  <span class="fu">coord_polar</span>()<span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb52-9"><a href="#cb52-9"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>)<span class="sc">+</span></span>
<span id="cb52-10"><a href="#cb52-10"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>, <span class="at">name =</span> <span class="st">"Species"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-polar2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-polar2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-polar2-1.png" class="img-fluid figure-img" data-fig-pos="H" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-polar2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;41: Stacked barplot with polar transformation
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="ridge-plot" class="level3" data-number="1.12">
<h3 data-number="1.12" class="anchored" data-anchor-id="ridge-plot"><span class="header-section-number">1.12</span> Ridge plot</h3>
<p>Although the <strong>ggridges</strong> package provides <code>geom_ridgeline</code> and <code>geom_density_ridges</code>, we focus on the latter because it has ability to estimates data densities and then draws those using ridgelines.The geom <code>geom_density_ridges</code> calculates density estimates from the provided data and then plots those, using the ridgeline visualization.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>lfq4 <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2"></a>  <span class="fu">mutate</span>(<span class="at">months =</span> lubridate<span class="sc">::</span><span class="fu">month</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4"></a>  ggridges<span class="sc">::</span><span class="fu">geom_density_ridges</span>(<span class="fu">aes</span>(<span class="at">x =</span> tl_mm, <span class="at">y =</span> months, <span class="at">fill =</span> site), <span class="at">alpha =</span> .<span class="dv">7</span>)<span class="sc">+</span></span>
<span id="cb53-5"><a href="#cb53-5"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>, <span class="at">name =</span> <span class="st">"Sampling</span><span class="sc">\n</span><span class="st">site"</span>)<span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">85</span>,.<span class="dv">2</span>), <span class="at">legend.background =</span> <span class="fu">element_rect</span>())<span class="sc">+</span></span>
<span id="cb53-8"><a href="#cb53-8"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Months"</span>, <span class="at">x =</span> <span class="st">"Total length (mm.)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="combining-multiple-plots" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="combining-multiple-plots"><span class="header-section-number">2</span> Combining multiple plots</h2>
<p>When exploring data with many variables, you’ll often want to make the same kind of plot (e.g.&nbsp;a violin plot) for several variables. It will frequently make sense to place these side-by-side in the same plot window. The <strong>patchwork</strong> package extends <strong>ggplot2</strong> by letting you do just that. Let’s install it:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="fu">install.packages</span>(<span class="st">"patchwork"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then load a package in the workspace</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">require</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To use <strong>patchwork</strong> <span class="citation" data-cites="patchwork">(<a href="#ref-patchwork" role="doc-biblioref">Pedersen, 2020</a>)</span>, save each plot as a plot object :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>plot.tl <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4,</span>
<span id="cb56-2"><a href="#cb56-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl_mm, <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total length (mm)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb56-6"><a href="#cb56-6"></a></span>
<span id="cb56-7"><a href="#cb56-7"></a> plot.wt <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lfq4,</span>
<span id="cb56-8"><a href="#cb56-8"></a>       <span class="fu">aes</span>(<span class="at">x =</span> wt_gm, <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb56-9"><a href="#cb56-9"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb56-10"><a href="#cb56-10"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Weight (gram)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb56-11"><a href="#cb56-11"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb56-12"><a href="#cb56-12"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>then add them together</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>plot.tl <span class="sc">+</span> plot.wt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-patchwork" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-patchwork-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-patchwork-1.png" class="img-fluid figure-img" data-fig-pos="H" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-patchwork-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;42: Density plot by sites for total length (left panel) and weight (right panel)
</figcaption>
</figure>
</div>
</div>
</div>
<p>`</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>plot.tl <span class="sc">/</span> plot.wt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-patchwork1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-patchwork1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-patchwork1-1.png" class="img-fluid figure-img" data-fig-pos="H" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-patchwork1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;43: Density plot by sites for total length (top panel) and weight (bottom panel)
</figcaption>
</figure>
</div>
</div>
</div>
<p>We need first to extract monsoon seasons from the dataset. We know from literature that the coasal waters of East Africa is affected by monsoon season, which is influenced trade winds, which is broadly categorized as;</p>
<ul>
<li>Northeast monsoon season — November through March</li>
<li>Southeast monsoon season — May to september</li>
<li>Intermonsoon season — April and October</li>
</ul>
<p>We can use the month information to break our dataset into three monsoon seasons as;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>lfq4.season <span class="ot">=</span> lfq4 <span class="sc">%&gt;%</span> </span>
<span id="cb59-2"><a href="#cb59-2"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> lubridate<span class="sc">::</span><span class="fu">month</span>(date),</span>
<span id="cb59-3"><a href="#cb59-3"></a>         <span class="at">season =</span> <span class="fu">case_when</span>(month <span class="sc">&gt;</span> <span class="dv">10</span> <span class="sc">|</span> month <span class="sc">&lt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"NE"</span>,</span>
<span id="cb59-4"><a href="#cb59-4"></a>                            month <span class="sc">&gt;=</span><span class="dv">5</span> <span class="sc">&amp;</span> month <span class="sc">&lt;</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"SE"</span>,</span>
<span id="cb59-5"><a href="#cb59-5"></a>                            month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"INT"</span>)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>month)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>plot.int <span class="ot">=</span>lfq4.season <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="#cb60-2"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"Voi"</span> <span class="sc">&amp;</span> season <span class="sc">==</span> <span class="st">"INT"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb60-3"><a href="#cb60-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tl_mm, <span class="at">y =</span> wt_gm))<span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb60-5"><a href="#cb60-5"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Total length (mm)"</span>)<span class="sc">+</span></span>
<span id="cb60-7"><a href="#cb60-7"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Weight (gram)"</span>)<span class="sc">+</span></span>
<span id="cb60-8"><a href="#cb60-8"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"label"</span>,<span class="at">x =</span> <span class="dv">120</span>, <span class="at">y =</span> <span class="dv">80</span>, <span class="at">label =</span> <span class="st">"Northeast</span><span class="sc">\n</span><span class="st">Season"</span>)</span>
<span id="cb60-9"><a href="#cb60-9"></a></span>
<span id="cb60-10"><a href="#cb60-10"></a>plot.ne <span class="ot">=</span> lfq4.season <span class="sc">%&gt;%</span> </span>
<span id="cb60-11"><a href="#cb60-11"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"Voi"</span> <span class="sc">&amp;</span> season <span class="sc">==</span> <span class="st">"NE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb60-12"><a href="#cb60-12"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tl_mm, <span class="at">y =</span> wt_gm))<span class="sc">+</span></span>
<span id="cb60-13"><a href="#cb60-13"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb60-14"><a href="#cb60-14"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb60-15"><a href="#cb60-15"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Total length (mm)"</span>)<span class="sc">+</span></span>
<span id="cb60-16"><a href="#cb60-16"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Weight (gram)"</span>)<span class="sc">+</span></span>
<span id="cb60-17"><a href="#cb60-17"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"label"</span>,<span class="at">x =</span> <span class="dv">140</span>, <span class="at">y =</span> <span class="dv">80</span>, <span class="at">label =</span> <span class="st">"Southeast</span><span class="sc">\n</span><span class="st">Season"</span>)</span>
<span id="cb60-18"><a href="#cb60-18"></a></span>
<span id="cb60-19"><a href="#cb60-19"></a>plot.se <span class="ot">=</span> lfq4.season <span class="sc">%&gt;%</span> </span>
<span id="cb60-20"><a href="#cb60-20"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"Voi"</span> <span class="sc">&amp;</span> season <span class="sc">==</span> <span class="st">"SE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb60-21"><a href="#cb60-21"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tl_mm, <span class="at">y =</span> wt_gm))<span class="sc">+</span></span>
<span id="cb60-22"><a href="#cb60-22"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb60-23"><a href="#cb60-23"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb60-24"><a href="#cb60-24"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Total length (mm)"</span>)<span class="sc">+</span></span>
<span id="cb60-25"><a href="#cb60-25"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Weight (gram)"</span>)<span class="sc">+</span></span>
<span id="cb60-26"><a href="#cb60-26"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"label"</span>,<span class="at">x =</span> <span class="dv">120</span>, <span class="at">y =</span> <span class="dv">80</span>, <span class="at">label =</span> <span class="st">"Inter</span><span class="sc">\n</span><span class="st"> Monsoon"</span>)</span>
<span id="cb60-27"><a href="#cb60-27"></a></span>
<span id="cb60-28"><a href="#cb60-28"></a>plot.all <span class="ot">=</span> lfq4.season <span class="sc">%&gt;%</span> </span>
<span id="cb60-29"><a href="#cb60-29"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"Voi"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb60-30"><a href="#cb60-30"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tl_mm, <span class="at">y =</span> wt_gm, <span class="at">color =</span> season))<span class="sc">+</span></span>
<span id="cb60-31"><a href="#cb60-31"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb60-32"><a href="#cb60-32"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb60-33"><a href="#cb60-33"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Total length (mm)"</span>)<span class="sc">+</span></span>
<span id="cb60-34"><a href="#cb60-34"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Weight (gram)"</span>)<span class="sc">+</span></span>
<span id="cb60-35"><a href="#cb60-35"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Yuo may plot One row with three plots and one row with a single plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>(plot.ne <span class="sc">+</span> plot.se <span class="sc">+</span> plot.int)<span class="sc">/</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>  plot.all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>Or one column with three plots and one column with a single plot `</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>plot.all <span class="sc">|</span> (plot.ne <span class="sc">/</span> plot.se <span class="sc">/</span> plot.int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="labelling-outliers" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="labelling-outliers"><span class="header-section-number">3</span> Labelling outliers</h2>
<p>Interactive plots are great when exploring a dataset but are not always possible to use in other contexts, e.g.&nbsp;for printed reports and some presentations. In these other cases, we can instead annotate the plot with notes about outliers. One way to do this is to use a geom called geom_text.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>lfq4.season <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="#cb63-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span>site <span class="sc">==</span> <span class="st">"Voi"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> wt_gm, <span class="at">fill =</span> season))<span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> .<span class="dv">4</span>, <span class="at">width =</span> .<span class="dv">29</span>)<span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">if_else</span>( wt_gm <span class="sc">&gt;</span> <span class="dv">175</span>, site, <span class="st">""</span>))) <span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"Monsoon season"</span>)<span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Weight (gram)"</span>)<span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="add-on-packages" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="add-on-packages"><span class="header-section-number">4</span> Add-on packages</h2>
<p>The R community has developed packages that extend the capability of <strong>ggplot2</strong>. Some of the packages include:</p>
<ul>
<li><strong>metR</strong>: Provide addition tools for plotting filled contour, and label contour lines</li>
<li><strong>ggrepel</strong>: Contains tools for automatically position non-overlapping text labels</li>
<li><strong>ggspatial</strong>: Spatial Data Framework for <strong>ggplot2</strong></li>
<li><strong>RcolorBrewer</strong>: Contains color palettes for continuous and discrete plots</li>
<li><strong>cowplot</strong>: Contains addition themes and tools to combine <strong>ggplot2</strong> plots in one panel</li>
<li><strong>egg</strong>: Provide tools for plot aligning and symmetrised <strong>ggplot2</strong> plots</li>
<li><strong>oce</strong>: Provide color pallete for visualization of Oceanographic Data</li>
<li><strong>ggsn</strong>: Provide tools for mapping North symbols and scale bars on maps created with <strong>ggplot2</strong></li>
<li><strong>gganimate</strong>: convert static ggplot2 plots to animations</li>
<li><strong>ggformula</strong>: adds some additional plot options to <strong>ggplot2</strong></li>
<li><strong>sf</strong> : Add capabilities of <strong>ggplot2</strong> to map spatial data such as simple features</li>
<li><strong>ggthemes</strong>: contains extra themes, scales, and geoms, and functions for and related to ggplot2</li>
<li><strong>ggridges</strong>: extend the geom_density function by plotiing closed polygons insted of ridgelines</li>
<li><strong>ggpmisc</strong></li>
</ul>
</section>
<section id="references" class="level2" data-number="5">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">5 References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-ggpmisc" class="csl-entry" role="listitem">
Aphalo, P.J., 2016. <a href="https://leanpub.com/learnr">Learn r ...as you learnt your mother tongue</a>. Leanpub.
</div>
<div id="ref-patchwork" class="csl-entry" role="listitem">
Pedersen, T.L., 2020. <a href="https://CRAN.R-project.org/package=patchwork">Patchwork: The composer of plots</a>.
</div>
<div id="ref-ggplot" class="csl-entry" role="listitem">
Wickham, H., 2016. <a href="https://ggplot2.tidyverse.org">ggplot2: Elegant graphics for data analysis</a>. Springer-Verlag New York.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{semba2024,
  author = {Semba, Masumbuko},
  title = {Basic Plots with Ggplot2},
  date = {2024-04-01},
  url = {https://lugoga.github.io/kitaa/posts/basicplots/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-semba2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Semba, M., 2024. Basic plots with ggplot2 [WWW Document]. URL <a href="https://lugoga.github.io/kitaa/posts/basicplots/">https://lugoga.github.io/kitaa/posts/basicplots/</a>
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="lugoga/kitaa" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>©2024 <a href="../../posts/basicplots/index.html">Datika</a></p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../faq.html">
<p>FAQ</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../feedback.html">
<p>Feedback</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../license.html">
<p>License</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../terms.html">
<p>Terms</p>
</a>
  </li>  
</ul>
    <div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>