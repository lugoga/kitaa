{
  "hash": "437b29a5fad134f44e6a6cdfe3758da4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Visualize changing catch landings with ggplot2\"\ndescription: \"The post takes step-by-step on generating a line plot using ggplot2 in R to visualize how the capture fisheries landing has changed over time. It also illustrate how to annotate plot to highlight specific aspects or data points\"\nauthor: \n  - name: Masumbuko Semba\n    url: https://semba.netlify.app\n    orcid: 0000-0002-5002-9747\n    affiliation: Nelson Mandela African Institution of Science and Technology\n    affiliation-url: https://semba.netlify.app/  \ncitation: \n    url: https://lugoga.github.io/kitaa/posts/visualize_line/\nbibliography: ../blog.bib\ncsl:  ../elsevier.csl\ndate: \"today\"\ntoc: true\ntoc-depth: 4\ncategories: [Data Science, Data Visualization, ggplot]\nimage: theplot.png\ncode-fold: false\nexecute: \n  warning: false\n  message: false\n  comment: \"\"\nfilters: \n  - webr\n---\n\n\n\n\n<!-- Google tag (gtag.js) -->\n<script async src=\"https://www.googletagmanager.com/gtag/js?id=G-8KY4TDP558\"></script>\n<script>\n  window.dataLayer = window.dataLayer || [];\n  function gtag(){dataLayer.push(arguments);}\n  gtag('js', new Date());\n\n  gtag('config', 'G-8KY4TDP558');\n</script>\n\n\n\n\n## Introduction\n\nIn this work, we will create a line plot to visualize the trends in fish landings over time, highlighting and annotating data from the Kenya, Uganda, and Tanzania. This plot aims to illustrate the rise and fall of fish landings in these countries, providing a comparative analysis of their fishing activities. \n\nThe line plot will feature data points representing fish landings across different years, allowing us to observe fluctuations and identify significant patterns or anomalies. By focusing on the Kenya, Uganda, and Tanzania, we can gain insights into the impact of various fishing policies, environmental changes, and market demands on their fishing industries.\n\nAnnotations will be strategically placed to highlight key events or trends, such as regulatory changes, shifts in fish population dynamics, or economic factors that influenced fish landings. This visual representation will help in understanding the complex interplay between these factors and their effects on fish landings.\n\nUsing ggplot2, a powerful data visualization package in R, we will ensure that the plot is not only informative but also aesthetically appealing. ggplot2 offers advanced customization options, enabling us to create a polished and professional graphic that effectively communicates the data.\n\n## Packages and data cleaup\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(tidyverse)\nrequire(magrittr)\n\ntheme_set(theme_minimal(base_size = 15)) # global theme\n```\n:::\n\n\nThe catch data is sourced from  *rfisheries* package, designed specifically to access  various fisheries data sources and APIs (Application Programming Interfaces). The given code chunk demonstrates how to use the *rfisheries* package to retrieve and combine fisheries landing data from multiple African countries into a single dataset. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nfisheries = bind_rows(\nrfisheries::of_landings(country = \"TZA\"),\nrfisheries::of_landings(country = \"KEN\"),\nrfisheries::of_landings(country = \"UGA\"),\nrfisheries::of_landings(country = \"EAZ\"),\nrfisheries::of_landings(country = \"MOZ\"),\nrfisheries::of_landings(country = \"MDG\"),\nrfisheries::of_landings(country = \"MUS\"),\nrfisheries::of_landings(country = \"NGA\"),\nrfisheries::of_landings(country = \"LBR\"),\nrfisheries::of_landings(country = \"LBY\"),\nrfisheries::of_landings(country = \"ETH\"),\nrfisheries::of_landings(country = \"EGY\"),\nrfisheries::of_landings(country = \"DJI\"),\nrfisheries::of_landings(country = \"TCD\"),\nrfisheries::of_landings(country = \"BEN\"),\nrfisheries::of_landings(country = \"AGO\"),\nrfisheries::of_landings(country = \"DZA\")\n)\n```\n:::\n\n\n\nThe aim of this code is to generate a consolidated dataset for conducting in-depth analysis of fish landings in various African countries. The dataset created above is the one we are going to use to plot fish landing sites over time to detect patterns and trends.\n\n\n## Visualize landing over time\n\nCreate a basic line graph to display the catch landing of capture fisheries in each country. The grey lines will provide a background for highlighting three specific countries later on.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nf1 = ggplot(data = fisheries |> filter(!country == \"NGA\"), aes(x = year, y = catch, group = country))+\n  geom_line(color = \"snow3\")\n\nf1 \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\nHighlight the cigarette sales in three selected countries.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nriparian = fisheries |> filter(country %in% c(\"TZA\", \"KEN\", \"UGA\"))\n\nf2 = f1 +\n  geom_line(data = riparian, \n            aes(color = country), linewidth = 1)+\n  scale_color_manual(values = c(\"skyblue3\", \"steelblue4\", \"firebrick\"))\n\nf2\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nReplace the default legend with text annotations for the three highlighted lines and use a text annotation to replace the default y-axis title. The default legend and y-axis title will be removed in a later step.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nf3 = f2 +\n  annotate(\n    geom = \"text\",\n    x = c(2009, 1986, 2008),\n    y = c(185164.3, 457018.2,501196),\n    hjust = c(1, 0, 0), # 1, right justify;  0, left justify\n    label = c(\"KENYA\", \"TANZANIA\", \"UGANDA\"),\n    color = c(\"skyblue3\", \"steelblue4\", \"firebrick\"),\n    fontface = \"bold\", size = c(5, 5, 5))\n\nf3 \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nModify the axis breaks and scales, eliminate axis titles, and include plot titles. When adding a long plot subtitle, utilize the `str_wrap()` function from the widely used stringr package to automatically format lengthy strings into neatly wrapped paragraphs.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nf4 = f3 + \n  labs(\n    # add plot title and subtitle\n    title = \"Total Capture Fisheries Landing in Selected African Countries\",\n    subtitle = str_wrap(\n      \"Landing of the East African Countries became increasingly popular since 1990s, peaked around 1995s ~ 2005s, and significant decreased in 2010s.\", \n      width = 85) # number of characters per line\n  )\n\nf4\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nThe final polish-up of the theme involves making the last adjustments and improvements to ensure that every detail is perfect. This stage may include refining the design elements, tweaking the color scheme, adjusting the layout, and making any necessary final edits. The goal is to achieve a polished and cohesive look that meets the desired aesthetic and functionality. This process ensures that the theme is ready for implementation and will provide a smooth and visually appealing experience for its users.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nf5 = f4 +\n  scale_x_continuous(breaks = seq(1950,2020,10))+\n  scale_y_continuous(\n    breaks = scales::pretty_breaks(n = 8), \n    labels = scales::label_number(big.mark = \",\"))+\n    theme(\n    axis.title = element_blank(),\n    legend.position = \"none\",\n    panel.grid = element_blank(),\n    panel.grid.major.y = element_line(linewidth = .1, linetype = \"dashed\"),\n    axis.line.x = element_line(color = \"snow4\"),\n    axis.ticks.x = element_line(color = \"snow4\"),\n    plot.title = element_text(face = \"bold\", size = 15),\n    plot.subtitle = element_text(size = 12, face = \"italic\", color = \"orange4\",\n                                 margin = margin(b = 15))) \n\nf5\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nThe whole code for the process involved is here;\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = fisheries |> filter(!country == \"NGA\"), aes(x = year, y = catch, group = country))+\n  geom_line(color = \"snow3\")+\n  geom_line(data = fisheries |> filter(country %in% c(\"TZA\", \"KEN\", \"UGA\")), \n            aes(color = country), linewidth = 1)+\n  scale_color_manual(values = c(\"skyblue3\", \"steelblue4\", \"firebrick\"))+\n  scale_x_continuous(breaks = seq(1950,2020,10))+\n  scale_y_continuous(\n    breaks = scales::pretty_breaks(n = 8), \n    labels = scales::label_number(big.mark = \",\"))+\n  annotate(\n    geom = \"text\",\n    x = c(2009, 1986, 2008),\n    y = c(185164.3, 457018.2,501196),\n    hjust = c(1, 0, 0), # 1, right justify;  0, left justify\n    label = c(\"KENYA\", \"TANZANIA\", \"UGANDA\"),\n    color = c(\"skyblue3\", \"steelblue4\", \"firebrick\"),\n    fontface = \"bold\", size = c(5, 5, 5)) +\n  # expand to fill up the entire plotting range\n  coord_cartesian(expand = 0.5) +\n  labs(\n    # add plot title and subtitle\n    title = \"Total Capture Fisheries Landing in Selected African Countries\",\n    subtitle = str_wrap(\n      \"Landing of the East African Countries became increasingly popular since 1990s, peaked around 1995s ~ 2005s, and significant decreased in 2010s.\", \n      width = 85) # number of characters per line\n  ) +\n    theme(\n    axis.title = element_blank(),\n    legend.position = \"none\",\n    panel.grid = element_blank(),\n    panel.grid.major.y = element_line(linewidth = .1, linetype = \"dashed\"),\n    axis.line.x = element_line(color = \"snow4\"),\n    axis.ticks.x = element_line(color = \"snow4\"),\n    plot.title = element_text(face = \"bold\", size = 15),\n    plot.subtitle = element_text(size = 12, face = \"italic\", color = \"orange4\",\n                                 margin = margin(b = 15))) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"theplot.png\", width = 6, height = 4, dpi = 300)\n```\n:::\n\n\n\n## Conclusion\n\nThis post describes the process of creating an annotated line plot in R using the ggplot2 library to visualize the changing capture fish landings, with a focus on the Kenya, Uganda and Tanzania.\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}